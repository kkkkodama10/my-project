# プロダクト要求定義書

## ユーザー課題

- 日常の思考・行動・学習を記録したいが、フォーマットを考えて書くのは面倒で続かない
- 記録が散在し（メモアプリ、チャット、頭の中）、後から振り返れない
- AI時代に向けて自分のコンテキスト（思考・行動・学習の履歴）を構造化して蓄積する手段がない

## プロダクトのゴール

LINEで雑にメモを送るだけで、AIが日報フォーマットに整形し、Notionに自動記録する**パーソナルライフログシステム**を構築する。最小限の労力で日常を構造化し、パーソナルコンテキストエンジンの基盤とする。

## ターゲットユーザー

- 自分自身（個人利用）

## ユーザーストーリー

1. ユーザーはLINEで雑なメモ（フォーマット自由）をBotに送信する
2. システムがメモを受信し、LLMで日報フォーマットに自動整形する
3. 整形結果がNotionのライフログデータベースに書き込まれる（同一日付なら追記）
4. 毎晩22:00にLINEでリマインド通知を受け取り、記録を促される

## スコープ

### MVP（対象）

- LINE Messaging APIによるメッセージ受信
- LLMによるメモの日報フォーマット整形
- Notion APIによるライフログデータベースへの書き込み（新規作成・同一日付への追記）
- 毎日のLINEリマインド送信（固定メッセージ）

### MVP外（将来の拡張）

- 曜日別リマインドメッセージ
- 1日の終わりのサマリー自動生成
- Apple Health連携（睡眠データ自動収集）
- YouTube視聴履歴の自動取り込み
- LLM会話ログの自動連携
- 週次・月次の振り返りレポート自動生成
- RAGによるコンテキスト検索
- ローカルLLM（Ollama）対応による完全無料化
- Notion MCP Server によるNotion操作のMCP化（API直接呼び出しからの移行）
- 天気・気温の自動記録（天気API経由で所在地の気象情報を日次取得しNotionに記録）

## 記録対象のコンテキスト

| カテゴリ | 記録内容 |
|---------|---------|
| 仕事 | 作業内容、考えたこと、就業時間 |
| インプット | YouTube、ドキュメンタリー、読んだもの |
| LLMログ | LLMに聞いたこと |
| 勉強 | 学習内容 |
| 子供の成長 | 子供の出来事・発達記録 |
| 睡眠 | 起床時刻・就寝時刻 |
| メモ | その他自由記述 |

## Notionデータベーススキーマ

| プロパティ | 型 | 説明 |
|-----------|------|------|
| 日付 | Date | 記録日 |
| 起床時刻 | Date（時刻含む） | 起きた時刻 |
| 就寝時刻 | Date（時刻含む） | 寝た時刻 |
| 就業時間 | Number（h） | その日の労働時間 |
| 仕事 | Rich Text | やったこと・考えたこと |
| インプット | Rich Text | 読んだ/見たもの |
| LLMログ | Rich Text | LLMに聞いたこと |
| 勉強 | Rich Text | 学習内容 |
| 子供の成長 | Rich Text | 子供の出来事・発達記録 |
| メモ | Rich Text | その他自由記述 |
| 元メッセージ | Rich Text | LINE送信の原文（整形前） |

## 運用ルール

- 1日に複数回送信した場合は、同一日付のレコードに追記する
- LLMが入力から各プロパティに自動振り分けする
- 振り分け不明な内容は「メモ」に格納する
- 起床/就寝は自然言語（「7時に起きた」等）から時刻を解析する
- 就業時間は自然言語（「8.5h働いた」「9時〜17時半」等）から数値に変換する

## コスト目標

- **MVPは無料（またはほぼ無料）** で運用する
- LLM APIコストはSonnet/Haikuの利用、またはローカルLLMで最小化する
- LINE無料枠（月200通）内で運用する（想定: 約60〜90通/月）

## セキュリティ要件

- 全レイヤーで最小権限の原則を適用する
- Docker内でOpenClawを実行し、ホストPCから隔離する
- Tailscale FunnelでWebhookポートのみ公開する
- OpenClawのexec/browserツールは無効化する
- Notion APIの権限はRead/Update/Insertのみ（Delete不可）
- LINE Botは自分専用（友だち登録は自分のみ）
