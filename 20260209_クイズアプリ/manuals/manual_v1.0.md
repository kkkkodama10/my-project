# Quiz App マニュアル v1.0

リアルタイム同時接続型クイズアプリケーションの操作マニュアルです。
複数の参加者がブラウザからリアルタイムで4択クイズに参加し、ランキングを競うことができます。

---

## 目次

- [第1部: ユーザー（参加者）向けマニュアル](#第1部-ユーザー参加者向けマニュアル)
  - [1. イベントに参加する](#1-イベントに参加する)
  - [2. ニックネームを登録する](#2-ニックネームを登録する)
  - [3. クイズに回答する](#3-クイズに回答する)
  - [4. 回答締め切り後](#4-回答締め切り後)
  - [5. 正解発表](#5-正解発表)
  - [6. 結果発表（ランキング）](#6-結果発表ランキング)
  - [7. その他の操作](#7-その他の操作)
- [第2部: 管理者向けマニュアル](#第2部-管理者向けマニュアル)
  - [1. 管理者ログイン](#1-管理者ログイン)
  - [2. 管理ダッシュボード](#2-管理ダッシュボード)
  - [3. マニュアルモードでの進行](#3-マニュアルモードでの進行)
  - [4. オートモードでの進行](#4-オートモードでの進行)
  - [5. イベントの終了・中断・リセット](#5-イベントの終了中断リセット)
  - [6. 問題管理](#6-問題管理)
  - [7. 新規問題の作成](#7-新規問題の作成)

---

# 第1部: ユーザー（参加者）向けマニュアル

## 1. イベントに参加する

ブラウザでアプリのトップページにアクセスすると、イベント参加画面が表示されます。

![イベント参加画面](v1.0/assets/スクリーンショット%202026-02-20%2010.41.48.png)

1. **参加コード** 欄に、管理者から案内された参加コード（例: `123456`）を入力します
2. **参加** ボタンをクリックします

## 2. ニックネームを登録する

参加コードが正しければ、ニックネーム登録画面に遷移します。

![ニックネーム登録画面](v1.0/assets/スクリーンショット%202026-02-20%2010.41.55.png)

1. **表示名ベース** 欄に好きな名前を入力します（デフォルト: `guest`）
2. **登録** ボタンをクリックします
3. 表示名は `入力した名前-ランダム4桁` の形式で自動生成されます（例: `guest-6352`）

登録が完了すると、クイズ画面に自動遷移し、管理者がクイズを開始するまで待機します。

## 3. クイズに回答する

管理者がクイズを開始し、問題を出題すると、以下のような画面が表示されます。

![クイズ回答画面](v1.0/assets/スクリーンショット%202026-02-20%2010.43.50.png)

- 画面上部に**参加者名**とログアウトボタンが表示されます
- グレーの背景部分に**問題文**が表示されます
- **締切** にカウントダウンタイマーが表示されます（制限時間内に回答してください）
- 4つの**選択肢ボタン**から正解だと思うものをタップ/クリックします

> **ポイント**: 回答が速いほどランキングで有利になります。正解数が同じ場合、回答時間の合計が短い人が上位にランクインします。

## 4. 回答締め切り後

回答を送信した後、または制限時間が過ぎると、選択肢がグレーアウトし回答受付が終了します。

![回答締め切り画面](v1.0/assets/スクリーンショット%202026-02-20%2010.43.56.png)

- 自分が選択した選択肢がハイライト表示されます
- 画面下部に **「回答受付終了 — あなたの回答は送信済みです」** と表示されます
- 管理者が正解を発表するまでこの画面で待機します

## 5. 正解発表

管理者が正解を発表すると、正解・不正解のフィードバックが表示されます。

![正解発表画面](v1.0/assets/スクリーンショット%202026-02-20%2010.44.08.png)

- **正解の選択肢**が緑色にハイライトされます
- 正解した場合は **「正解!」** と表示されます
- 不正解の場合は **「不正解...」** と表示され、自分の回答が赤色、正解が緑色で示されます

## 6. 結果発表（ランキング）

すべての問題が終了すると、結果発表画面に自動遷移します。

![結果発表画面](v1.0/assets/スクリーンショット%202026-02-20%2010.44.22.png)

ランキング表には以下の情報が表示されます:

| 列名 | 説明 |
|------|------|
| 順位 | 総合ランキングの順位 |
| 名前 | 参加者の表示名 |
| 正解数 | 正解した問題の数 |
| 未回答 | 回答しなかった問題の数 |
| 正答率 | 正解数 / 全問題数 |
| 回答時間合計 | 全問題の回答にかかった合計時間 |

> **ランキングの基準**: 正解数が多い順 → 同率の場合は回答時間合計が短い順

## 7. その他の操作

- **ログアウト**: 画面右上の「ログアウト」ボタンから退出できます
- **ページ再読み込み**: ブラウザを再読み込みしてもセッションは維持されます
- **接続切断時**: WebSocket接続が切れた場合、自動的にポーリングモードに切り替わり、画面に「ポーリングで更新中」と表示されます

---

# 第2部: 管理者向けマニュアル

## 1. 管理者ログイン

ブラウザで `/admin` にアクセスすると、管理者ログイン画面が表示されます。

![管理者ログイン画面](v1.0/assets/スクリーンショット%202026-02-20%2010.42.25.png)

1. **パスワード** 欄に管理者パスワードを入力します
2. **ログイン** ボタンをクリックします

ログインに成功すると管理ダッシュボードに遷移します。セッションは24時間有効で、ブラウザを再読み込みしても維持されます。

## 2. 管理ダッシュボード

ログイン後、管理ダッシュボードが表示されます。

![管理ダッシュボード（マニュアルモード）](v1.0/assets/スクリーンショット%202026-02-20%2010.42.34.png)

ダッシュボードの構成:

- **画面上部右**: 「問題管理」リンク、「ログアウト」ボタン
- **フェーズ表示**: 現在のイベント状態（waiting / started / question_shown / question_closed / finished）
- **進行モード切替**: マニュアル / オート のラジオボタン
- **操作ボタン群**: Start / Next Question / Close Question / Reveal Answer / Finish / Abort / Reset
- **Action log**: 管理操作の履歴ログ

## 3. マニュアルモードでの進行

マニュアルモードでは、管理者がボタン操作で1ステップずつクイズを進行します。

### イベントの流れ

**Step 1: イベント開始**

「Start」ボタンをクリックしてイベントを開始します。フェーズが `started` に変わります。

![イベント開始](v1.0/assets/スクリーンショット%202026-02-20%2010.43.14.png)

**Step 2: 問題出題**

「Next Question」ボタンをクリックすると、次の問題が参加者に配信されます。フェーズが `question_shown` に変わり、問題IDが表示されます。

![問題出題中](v1.0/assets/スクリーンショット%202026-02-20%2010.43.18.png)

**Step 3: 回答締め切り**

「Close Question」ボタンをクリックすると、回答受付を終了します。フェーズが `question_closed` に変わります。

![回答締め切り](v1.0/assets/スクリーンショット%202026-02-20%2010.43.23.png)

**Step 4: 正解発表**

「Reveal Answer」ボタンをクリックすると、参加者に正解が表示されます。

**Step 5: 次の問題へ**

「Next Question」ボタンをクリックして次の問題へ進みます。Step 2〜4 を繰り返します。

**Step 6: イベント終了**

全問題が終了したら「Finish」ボタンをクリックします。参加者は結果発表画面に自動遷移します。

![イベント終了](v1.0/assets/スクリーンショット%202026-02-20%2010.43.29.png)

終了後、**「結果 CSV ダウンロード」** ボタンが表示され、結果データをCSV形式でエクスポートできます。

## 4. オートモードでの進行

オートモードでは、問題の出題から正解発表までを自動的に進行します。

![オートモード設定](v1.0/assets/スクリーンショット%202026-02-20%2010.42.41.png)

### オートモードの設定項目

| 設定項目 | 説明 | デフォルト値 |
|----------|------|-------------|
| シンキングタイム (s) | 問題表示から回答締切までの追加待ち時間 | 2秒 |
| 締め切り待機 (s) | 回答締切後、正解発表までの待ち時間 | 3秒 |
| 解答表示 (s) | 正解発表後、次の問題へ進むまでの待ち時間 | 2秒 |

> **注意**: 回答時間は「サーバー設定 (`time_limit_sec`) に連動」と表示されている通り、サーバー側の制限時間設定と連動します。

### オートモードの進行

1. 進行モードを **オート** に切り替えます
2. 各タイミングの秒数を必要に応じて調整します
3. 「Start」ボタンでイベントを開始します

開始後、画面上部にカウントダウンバナーが表示され、各ステップの残り時間が確認できます。

![オートモード進行中](v1.0/assets/スクリーンショット%202026-02-20%2010.42.58.png)

- 青色バナーに **「オート進行中 — 回答締切まで: ○秒」** のように現在のステップと残り時間が表示されます
- 全問題が終了するまで自動で進行します

## 5. イベントの終了・中断・リセット

| ボタン | 機能 | 説明 |
|--------|------|------|
| **Finish** | 正常終了 | クイズを終了し、参加者を結果発表画面へ遷移させます |
| **Abort** | 中断 | クイズを強制中断します。参加者に中断が通知されます |
| **Reset** | リセット | イベントを `waiting` 状態に戻します。新しいクイズを始める前に使用します |

> **注意**: Abort と Reset は取り消しができません。実行前に確認してください。

## 6. 問題管理

ダッシュボード右上の **「問題管理」** リンクから問題管理画面に遷移します。

![問題管理画面](v1.0/assets/スクリーンショット%202026-02-20%2010.44.30.png)

問題管理画面では以下の操作が可能です:

- **問題一覧の確認**: 登録済みの問題が一覧表示されます。各問題には問題文、選択肢、正解（太字表示）が表示されます
- **有効/無効の切替**: 各問題の右側にある「有効」チェックボックスで、その問題をクイズに含めるかどうかを切り替えられます
- **並び替え**: ドラッグ＆ドロップで問題の出題順を変更できます
- **編集**: 問題をクリックして内容を編集できます
- **削除**: 問題を削除できます
- **ダッシュボードへ戻る**: 右上の「← ダッシュボードへ」リンクから戻れます

## 7. 新規問題の作成

問題管理画面上部の **「+ 新規問題」** ボタンをクリックすると、問題作成フォームが表示されます。

![新規問題作成フォーム](v1.0/assets/スクリーンショット%202026-02-20%2010.44.38.png)

### 入力項目

| 項目 | 説明 |
|------|------|
| 問題文 | クイズの問題文を入力します（最大300文字） |
| 問題画像 | 問題に画像を添付する場合、ファイルを選択します（PNG/JPEG対応） |
| 選択肢 1〜4 | 4つの選択肢を入力します |
| 正解（ラジオボタン） | 正解の選択肢をラジオボタンで1つ選択します |
| 有効 | チェックを入れるとクイズに含まれます |

### 操作ボタン

- **保存**: 問題を保存します
- **キャンセル**: 入力を破棄してフォームを閉じます

---

## 付録: クイズの全体フロー

```
[管理者] イベント準備
    │
    ├── 問題を作成・編集・並び替え
    ├── 進行モード（マニュアル/オート）を選択
    │
    ▼
[管理者] Start ボタンでイベント開始
    │
    ▼
[参加者] 参加コードで入室 → ニックネーム登録
    │
    ▼
┌─────────────────────────────────────┐
│  問題ループ（全問題完了まで繰り返し）  │
│                                     │
│  [管理者] Next Question → 問題配信   │
│  [参加者] 選択肢を選んで回答         │
│  [管理者] Close Question → 締め切り  │
│  [管理者] Reveal Answer → 正解発表   │
│                                     │
└─────────────────────────────────────┘
    │
    ▼
[管理者] Finish ボタンでイベント終了
    │
    ▼
[参加者] 結果発表画面でランキング確認
[管理者] 結果 CSV ダウンロード
```
